
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Chris Howland">
      
      
        <link rel="canonical" href="https://chowland.github.io/AFiD-MuRPhFi/ibm/">
      
      
        <link rel="prev" href="../stretched_grids/">
      
      
        <link rel="next" href="../spectra/">
      
      
      <link rel="icon" href="../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.20">
    
    
      
        <title>Immersed boundary method - AFiD-MuRPhFi Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.66ac8b77.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-orange" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#immersed-boundary-method" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="AFiD-MuRPhFi Documentation" class="md-header__button md-logo" aria-label="AFiD-MuRPhFi Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M288 32c0 17.7 14.3 32 32 32h32c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h320c53 0 96-43 96-96S405 0 352 0h-32c-17.7 0-32 14.3-32 32zm64 352c0 17.7 14.3 32 32 32h32c53 0 96-43 96-96s-43-96-96-96H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h384c17.7 0 32 14.3 32 32s-14.3 32-32 32h-32c-17.7 0-32 14.3-32 32zM128 512h32c53 0 96-43 96-96s-43-96-96-96H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h128c17.7 0 32 14.3 32 32s-14.3 32-32 32h-32c-17.7 0-32 14.3-32 32s14.3 32 32 32z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AFiD-MuRPhFi Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Immersed boundary method
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/chowland/AFiD-MuRPhFi" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    chowland/AFiD-MuRPhFi
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="AFiD-MuRPhFi Documentation" class="md-nav__button md-logo" aria-label="AFiD-MuRPhFi Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M288 32c0 17.7 14.3 32 32 32h32c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h320c53 0 96-43 96-96S405 0 352 0h-32c-17.7 0-32 14.3-32 32zm64 352c0 17.7 14.3 32 32 32h32c53 0 96-43 96-96s-43-96-96-96H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h384c17.7 0 32 14.3 32 32s-14.3 32-32 32h-32c-17.7 0-32 14.3-32 32zM128 512h32c53 0 96-43 96-96s-43-96-96-96H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h128c17.7 0 32 14.3 32 32s-14.3 32-32 32h-32c-17.7 0-32 14.3-32 32s14.3 32 32 32z"/></svg>

    </a>
    AFiD-MuRPhFi Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/chowland/AFiD-MuRPhFi" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    chowland/AFiD-MuRPhFi
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AFiD-MuRPhFi Quick Start Guide
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Usage
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../prerequisites/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installing prerequisites
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../inputs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Input file overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../outputs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Output file overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mean_outs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quantities saved to `means.h5`
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jupyter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Post-processing: Jupyter notebooks on HPCs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paraview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3D visualization with ParaView
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/rbc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rayleigh-Bénard Convection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/ddc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Double-diffusive convection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/stefan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stefan problems
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/coupled_flows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flows coupled to phase change
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Benchmarking and validation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Benchmarking and validation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scaling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scaling performance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../convergence/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Convergence tests
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../phasefield_validation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phase-field model validation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Technical Details
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Technical Details
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../equations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Governing equations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../numerics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Numerical time stepping scheme
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../interpolation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hermite interpolation between grids
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stretched_grids/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spatial derivatives
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Immersed boundary method
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Immersed boundary method
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#modification-to-the-implicit-solver" class="md-nav__link">
    <span class="md-ellipsis">
      Modification to the implicit solver
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Modification to the implicit solver">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#solid-points-ibmask0" class="md-nav__link">
    <span class="md-ellipsis">
      Solid points (ibmask==0)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boundary-points-ibmask1" class="md-nav__link">
    <span class="md-ellipsis">
      Boundary points (ibmask==±1)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#temperature-at-the-boundary" class="md-nav__link">
    <span class="md-ellipsis">
      Temperature at the boundary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#concentration-field-no-flux-conditions-and-multi-resolution-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Concentration field: No-flux conditions and multi-resolution considerations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spectra/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Power spectra and time-averaging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rainy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Moist convection module - Rainy-Bénard
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#modification-to-the-implicit-solver" class="md-nav__link">
    <span class="md-ellipsis">
      Modification to the implicit solver
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Modification to the implicit solver">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#solid-points-ibmask0" class="md-nav__link">
    <span class="md-ellipsis">
      Solid points (ibmask==0)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boundary-points-ibmask1" class="md-nav__link">
    <span class="md-ellipsis">
      Boundary points (ibmask==±1)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#temperature-at-the-boundary" class="md-nav__link">
    <span class="md-ellipsis">
      Temperature at the boundary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#concentration-field-no-flux-conditions-and-multi-resolution-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Concentration field: No-flux conditions and multi-resolution considerations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="immersed-boundary-method">Immersed boundary method</h1>
<p>When using the immersed boundary method, we use the direct forcing method as described by <a href="https://doi.org/10.1006/jcph.2000.6484">Fadlun et al. (2000)</a>.
This must be incorporated into the solution of the implicit step of the time stepper, and is taken care of by the subroutines <code>SolveImpEqnUpdateXX_ibm</code> stored in the <code>ibm</code> subdirectory.
We distinguish points as either solid/fluid/boundary using the arrays <code>ibmaskXX</code>.</p>
<h2 id="modification-to-the-implicit-solver">Modification to the implicit solver</h2>
<p>We show below the modifications to the implicit solve for the wall-normal velocity component <span class="arithmatex">\(u\)</span> (or <code>vx</code>) but the other components are analogous.
In solving the implicit step, we solve the matrix system</p>
<div class="arithmatex">\[
a_{ij} (\Delta u)_j = RHS^*_{i} ,
\]</div>
<p>where in the standard fluid domain <span class="arithmatex">\(a_{ij}\)</span> defines the wall-normal diffusion operator (see <a href="../numerics/#crank-nicolson-semi-implicit-diffusion">the time stepper documentation</a> for more details).
Recall that <span class="arithmatex">\(\Delta u = u^{l+1} - u^l\)</span> is the velocity increment over the RK substep.
For all points away from the solid immersed boundaries, <span class="arithmatex">\(RHS^*\)</span> is simply the sum of the explicit terms and the explicit portion of the Crank-Nicolson term.</p>
<h3 id="solid-points-ibmask0">Solid points (<code>ibmask==0</code>)</h3>
<p>Inside the solid, we enforce <span class="arithmatex">\(u^{l+1}=0\)</span>.
If we consider the velocity at position <span class="arithmatex">\(x_k\)</span>, this is achieved by setting <span class="arithmatex">\(a_{kk}=1\)</span>, and <span class="arithmatex">\(a_{kj}=0\)</span> for <span class="arithmatex">\(j\neq k\)</span>, with <span class="arithmatex">\(RHS^*_k=-u^l_k\)</span>.</p>
<div class="arithmatex">\[
(1)\Delta u = u^{l+1} - u^l = RHS^* = -u^l \quad \Rightarrow u^{l+1}=0 .
\]</div>
<p>Ideally, in the solid <span class="arithmatex">\(u^l\)</span> would be zero, but the pressure correction can introduce small velocities in the solid, so it is good practice to ensure the right hand side exactly cancels this previous velocity.</p>
<h3 id="boundary-points-ibmask1">Boundary points (<code>ibmask==±1</code>)</h3>
<p>The boundary points are where we must take the most care.
These points are defined as being those grid points adjacent (in the wall-normal direction <code>x</code>) to the immersed solids.
For the points just above the interface, we set <code>ibmask=1</code> and for points just below a solid we set <code>ibmask=-1</code>, and we do not solve the Navier--Stokes equations.
Rather, we interpolate the velocity linearly between the boundary and the second point into the liquid:</p>
<div class="arithmatex">\[
u_k^{l+1} = \frac{\delta_2}{\delta_1 + \delta_2} u_{k+1}^{l+1} ,
\]</div>
<p>where <span class="arithmatex">\(\delta_1\)</span> is the <span class="arithmatex">\(x\)</span>-distance between the first two grid points in the fluid, and <span class="arithmatex">\(\delta_2\)</span> is the <span class="arithmatex">\(x\)</span>-distance between the first fluid grid point and the solid boundary.</p>
<p>Since the interpolation involves the adjacent velocity at the next time step, this requires a further modification to the implicit solver.
Rewriting in terms of the velocity increments, the condition we want to impose is</p>
<div class="arithmatex">\[
\Delta u_k - \frac{\delta_2}{\delta_1 + \delta_2} \Delta u_{k+1} = \frac{\delta_2}{\delta_1 + \delta_2} u_{k+1}^l - u_k^l
\]</div>
<p>Note also that <span class="arithmatex">\(k+1\)</span> will be replaced by <span class="arithmatex">\(k-1\)</span> for boundary points where the liquid phase is below the solid boundary.
The matrix for the implicit solver therefore reads</p>
<div class="arithmatex">\[
a_{kj} = \begin{cases} 1 &amp; j=k \\ -\delta_2/(\delta_1+\delta_2) &amp; j= k+1 \\ 0 &amp; \textrm{otherwise} \end{cases}
\]</div>
<p>with <span class="arithmatex">\(RHS^*\)</span> calculated as the right hand side of the equation above.
This step is performed in the <code>SolveImpEqnUpdate*_ibm</code> routines, where the distance ratio in the above expressions is stored in the arrays <code>distx</code>, <code>disty</code>,... which are defined in <code>topogr_ibm</code>.</p>
<h3 id="temperature-at-the-boundary">Temperature at the boundary</h3>
<p>The above treatment of the boundary points is a special case enforcing a fixed velocity of zero.
For the temperature field, sometimes we want to enforce a specific non-zero temperature in the solid.
This can be achieved simply by prescribing</p>
<div class="arithmatex">\[
T_k = T_b + \frac{T_{k+1} - T_b}{\delta_1 + \delta_2} \delta_2 = \frac{\delta_2}{\delta_1 + \delta_2} T_{k+1} + \left( 1 - \frac{\delta_2}{\delta_1 + \delta_2} \right) T_b
\]</div>
<p>where <span class="arithmatex">\(T_b\)</span> is the fixed temperature enforced in the solid boundaries.
Compared to the above case of zero velocity, all that is required is and addition of <span class="arithmatex">\(T_b\)</span> to the <span class="arithmatex">\(RHS^*\)</span> in the solid points, and an addition of <span class="arithmatex">\((1 - \delta_2/(\delta_1 + \delta_2)) T_b\)</span> to the <span class="arithmatex">\(RHS^*\)</span> for the boundary points.</p>
<h3 id="concentration-field-no-flux-conditions-and-multi-resolution-considerations">Concentration field: No-flux conditions and multi-resolution considerations</h3>
<p>Imposing zero-flux conditions at the immersed boundary is a bit more troublesome than enforcing a fixed value.
Due to the complex nature of the three-dimensional semi-implicit time stepping on a staggered grid, we enforce zero gradients in <em>every</em> direction for points across the boundaries rather than only the normal gradient.
In the wall-normal direction, we apply a similar approach to that above.</p>
<p>A key difference here, is that the boundary points denoted <code>ibmask=±1</code> are now the closest points to the boundary <em>inside</em> the solid.
Consider the point <span class="arithmatex">\(x_k\)</span> being one of these such boundary points.
For the concentration field <span class="arithmatex">\(C\)</span>, we then assume that <span class="arithmatex">\(\partial_x C=0\)</span> across the boundary by setting <span class="arithmatex">\(C_{k}\)</span> equal to <span class="arithmatex">\(C_{k+1}\)</span>:</p>
<div class="arithmatex">\[
C_k^{l+1} = C_{k+1}^{l+1} \ \Rightarrow \Delta C_k - \Delta C_{k+1} = C_{k+1}^l - C_k^l
\]</div>
<p>This is implemented in the same way as above into the implicit solver, just without any length ratios since they are not needed here.</p>
<p>In the horizontal directions, there is no implicit step, so we cannot apply direct forcing for the immersed boundary method.
To apply the zero-gradient condition, we locate the points adjacent to the boundary.
At these points, we can write out the diffusive term as</p>
<div class="arithmatex">\[
\kappa \partial_{yy} C = \frac{\kappa (C_{j+1} - C_j) - \kappa (C_j - C_{j-1})}{(\Delta y)^2}
\]</div>
<p>and set <span class="arithmatex">\(C_{j-1}=C_j\)</span> to eliminate half of the expression (where we consider point <span class="arithmatex">\(y_{j-1}\)</span> to be in the solid phase) and impose <span class="arithmatex">\(\partial_y C=0\)</span> across the boundary.
For diffusion in the <span class="arithmatex">\(x\)</span>-direction, we do not need to hard-code the modified diffusion since the direct immersed boundary forcing overrides the diffusion at the relevant points.</p>
<p>Since the concentration field inside the solid has no physical meaning, we can do whatever is most convenient numerically for the points inside the solid (away from the boundary).
This has no effect on the surrounding fluid region, since we have prescribed all the boundary points.
In the current implementation, we choose to allow diffusion of <span class="arithmatex">\(C\)</span> inside the solid, such that the global solution is relatively smooth, which leads to a more reliable interpolation of <span class="arithmatex">\(C\)</span> onto the coarse velocity grid.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.dd8806f2.min.js"></script>
      
        <script src="../javascripts/katex.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
      
        <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
      
    
  </body>
</html>